<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1511px" height="771px" viewBox="-0.5 -0.5 1511 771" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2021-06-20T10:11:46.433Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/14.6.13 Chrome/89.0.4389.128 Electron/12.0.7 Safari/537.36&quot; etag=&quot;TNC4gPezfcPsVJXvEnt7&quot; version=&quot;14.6.13&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;C5RBs43oDa-KdzZeNtuy&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-934-141-132-26-0"><rect x="934" y="141" width="132" height="26"/></clipPath><clipPath id="mx-clip-964-301-302-74-0"><rect x="964" y="301" width="302" height="74"/></clipPath><clipPath id="mx-clip-964-383-302-52-0"><rect x="964" y="383" width="302" height="52"/></clipPath><clipPath id="mx-clip-1344-351-152-34-0"><rect x="1344" y="351" width="152" height="34"/></clipPath><clipPath id="mx-clip-1344-393-152-26-0"><rect x="1344" y="393" width="152" height="26"/></clipPath><clipPath id="mx-clip-554-231-242-34-0"><rect x="554" y="231" width="242" height="34"/></clipPath><clipPath id="mx-clip-554-273-242-52-0"><rect x="554" y="273" width="242" height="52"/></clipPath></defs><g><path d="M 930 136 L 930 110 L 1070 110 L 1070 136" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 930 136 L 930 162 L 1070 162 L 1070 136" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 930 136 L 1070 136" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" text-anchor="middle" font-size="12px"><text x="999.5" y="127.5">Cache</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-934-141-132-26-0)" font-size="12px"><text x="935.5" y="153.5">cache: cache</text></g><path d="M 960 296 L 960 270 L 1270 270 L 1270 296" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 960 296 L 960 430 L 1270 430 L 1270 296" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 960 296 L 1270 296" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1114.5" y="287.5">cache</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-964-301-302-74-0)" font-size="12px"><text x="965.5" y="313.5">defaultExpiration: time.Duration</text><text x="965.5" y="327.5">items: map[string]Item</text><text x="965.5" y="341.5">mu: sync.Mutex</text><text x="965.5" y="355.5">onEvicted: func(string, interface{})</text><text x="965.5" y="369.5">janitor: *janitor</text></g><path d="M 960 374 L 1270 374" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-964-383-302-52-0)" font-size="12px"><text x="965.5" y="395.5">Set(k string, x interface{}, d time.Duration):  </text><text x="965.5" y="409.5">Get(k string): interface{}, bool</text><text x="965.5" y="423.5">Delete(k string)</text></g><path d="M 1340 346 L 1340 320 L 1500 320 L 1500 346" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1340 346 L 1340 414 L 1500 414 L 1500 346" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1340 346 L 1500 346" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="1419.5" y="337.5">Item</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1344-351-152-34-0)" font-size="12px"><text x="1345.5" y="363.5">Object: interface{}</text><text x="1345.5" y="377.5">Expiration: int64</text></g><path d="M 1340 384 L 1500 384" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-1344-393-152-26-0)" font-size="12px"><text x="1345.5" y="405.5">Expired(): bool</text></g><path d="M 550 226 L 550 200 L 800 200 L 800 226" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 226 L 550 320 L 800 320 L 800 226" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 226 L 800 226" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" pointer-events="none" text-anchor="middle" font-size="12px"><text x="674.5" y="217.5">janitor</text></g><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-554-231-242-34-0)" font-size="12px"><text x="555.5" y="243.5">Interval: time.Duration</text><text x="555.5" y="257.5">stop: chan bool</text></g><path d="M 550 264 L 800 264" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" pointer-events="none" clip-path="url(#mx-clip-554-273-242-52-0)" font-size="12px"><text x="555.5" y="285.5">Run(c *cache)</text><text x="555.5" y="299.5">stopJanitor(c *Cache)</text><text x="555.5" y="313.5">runJanitor(c *cache, ci time.Duration)</text></g><path d="M 1070 149 L 1112.78 264.03" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1114.61 268.95 L 1108.89 263.61 L 1112.78 264.03 L 1115.45 261.17 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 198px; margin-left: 1089px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; background-color: #ffffff; white-space: nowrap; ">实际的Get/Set/Delete请求<br />都转移到cache来进行</div></div></div></foreignObject><text x="1089" y="202" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">实际的Get/Set/Delete请求...</text></switch></g><path d="M 1270 333 L 1337.29 335.61" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1325.16 341.65 L 1338.4 335.65 L 1325.66 328.66" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 799.25 283.5 L 956.83 284.39" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 944.92 290.82 L 957.95 284.39 L 944.99 277.82" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 284px; margin-left: 879px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; background-color: #ffffff; white-space: nowrap; ">janitor是外围,<br />工作是定期清理<br />cache中过期的items<br />解耦了cache核心功能<br />和过期维护</div></div></div></foreignObject><text x="879" y="287" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">janitor是外围,...</text></switch></g><path d="M 959 370 L 510 370 Q 500 370 500 360 L 500 224 Q 500 214 510 214.06 L 545.26 214.27" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 533.34 220.7 L 546.38 214.27 L 533.42 207.7" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 370px; margin-left: 706px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; background-color: #ffffff; white-space: nowrap; ">通过<font color="#ff3333">runtime.SetFinalizer(C, stopJanitor)</font><br />将janitor定期清理过期缓存的goroutine<br />与cache实例的生命周期绑定。<br />也避免了需要用户手动调用cache.Close()类的操作！</div></div></div></foreignObject><text x="706" y="373" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">通过runtime.SetFinalizer(C, stopJanitor)...</text></switch></g><rect x="710" y="10" width="580" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 40px; margin-left: 1000px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">func New(defaultExpiration, cleanupInterval time.Duration) *Cache<br /><div style="text-align: left"><span>* defaultExpiration：若小于1则不过期</span></div><div style="text-align: left"><span>* cleanupInterval：若小于1表示不自动删除过期item - 不运行janitor。需要手动调用c.DeleteExpired()</span></div></div></div></div></foreignObject><text x="1000" y="44" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">func New(defaultExpiration, cleanupInterval time.Duration) *Cache...</text></switch></g><path d="M 1003 109.5 L 993 109.5 L 993 89.5 L 982.5 89.5 L 998 70.5 L 1013.5 89.5 L 1003 89.5 Z" fill="none" stroke="#000000" stroke-linejoin="round" stroke-miterlimit="10" pointer-events="none"/><path d="M 1250 470 L 1450 470 L 1470 490 L 1470 580 L 1250 580 L 1250 470 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1450 470 L 1450 490 L 1470 490" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 218px; height: 1px; padding-top: 525px; margin-left: 1252px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">e := time.Now().Add(d).UnixNano()<br /><div>c.mu.Lock()</div><div><span>	</span>c.items[k] = Item{</div><div><span></span>    Object:     x,</div><div><span></span>    Expiration: e,</div><div><span>	</span>}</div><div><span>	</span>c.mu.Unlock()</div></div></div></div></foreignObject><text x="1252" y="529" fill="#000000" font-family="Helvetica" font-size="12px">e := time.Now().Add(d).UnixNano()...</text></switch></g><path d="M 1190 390 L 1250 470" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 970 530 L 1210 530 L 1230 550 L 1230 760 L 970 760 L 970 530 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1210 530 L 1210 550 L 1230 550" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 258px; height: 1px; padding-top: 645px; margin-left: 972px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>c.mu.RLock()</div><div><span>	</span>item, found := c.items[k]</div><div><span>	</span>if !found {</div><div><span></span>    c.mu.RUnlock()</div><div><span></span>    return nil, false</div><div><span>	</span>}</div><div><span>	</span>if item.Expiration &gt; 0 {</div><div><span></span>    if time.Now().UnixNano() &gt; item.Expiration {</div><div><span></span>        c.mu.RUnlock()</div><div><span></span>        return nil, false</div><div><span></span>    }</div><div><span>	</span>}</div><div><span>	</span>c.mu.RUnlock()</div><div><span>	</span>return item.Object, true</div></div></div></div></foreignObject><text x="972" y="649" fill="#000000" font-family="Helvetica" font-size="12px">c.mu.RLock()...</text></switch></g><path d="M 1159.54 524.71 L 1119.96 409.98" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 800 470 L 920 470 L 940 490 L 940 570 L 800 570 L 800 470 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 920 470 L 920 490 L 940 490" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 520px; margin-left: 801px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div style="text-align: left"><span>	</span>c.mu.Lock()</div><div style="text-align: left"><span>	</span>v, evicted := c.delete(k)</div><div style="text-align: left"><span>	</span>c.mu.Unlock()</div><div style="text-align: left"><span>	</span>if evicted {</div><div style="text-align: left"><span></span>    c.onEvicted(k, v)</div><div style="text-align: left"><span>	</span>}</div></div></div></div></foreignObject><text x="870" y="524" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">c.mu.Lock()...</text></switch></g><path d="M 893.52 467.7 L 969.92 420.02" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 277 330 L 387 330 L 407 350 L 407 380 L 277 380 L 277 330 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 387 330 L 387 350 L 407 350" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 128px; height: 1px; padding-top: 355px; margin-left: 278px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">c.janitor.stop &lt;- true</div></div></div></foreignObject><text x="342" y="359" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">c.janitor.stop &lt;- true</text></switch></g><path d="M 297.02 330 L 560 299.98" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 410 414 L 550 414 L 570 434 L 570 520 L 410 520 L 410 414 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 550 414 L 550 434 L 570 434" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 467px; margin-left: 412px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>j := &amp;janitor{</div><div><span></span>    Interval: ci,</div><div><span></span>    stop:     make(chan bool),</div><div><span>	</span>}</div><div><span>	</span>c.janitor = j</div><div><span>	</span>go j.Run(c)</div></div></div></div></foreignObject><text x="412" y="471" fill="#000000" font-family="Helvetica" font-size="12px">j := &amp;janitor{...</text></switch></g><path d="M 490 414 L 580 310.02" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 240 120 L 430 120 L 450 140 L 450 284 L 240 284 L 240 120 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 430 120 L 430 140 L 450 140" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 202px; margin-left: 242px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>ticker := time.<font color="#ff6666">NewTicker</font>(j.Interval)</div><div><span>	</span>for {</div><div><span></span>    select {</div><div><span></span>    case &lt;-ticker.C:</div><div><span></span>        c.DeleteExpired()</div><div><span></span>    case &lt;-j.stop:</div><div><span></span>        ticker.Stop()</div><div><span></span>        return</div><div><span></span>    }</div><div><span>	</span>}</div></div></div></div></foreignObject><text x="242" y="206" fill="#000000" font-family="Helvetica" font-size="12px">ticker := time.NewTicker(j.Interval...</text></switch></g><path d="M 450 212 L 560 280.01" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><rect x="10" y="20" width="190" height="210" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 188px; height: 1px; padding-top: 125px; margin-left: 12px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><div>目录：</div><div><br /></div><div>go-cache</div><div>├── CONTRIBUTORS</div><div>├── LICENSE</div><div>├── README.md</div><div>├── cache.go</div><div>├── cache_test.go</div><div>├── go.mod</div><div>├── sharded.go</div><div>└── sharded_test.go</div><div><br /></div><div>实际就是全部实现都在cache.go中</div><div>sharded.go里面是实验版本</div></div></div></div></foreignObject><text x="12" y="129" fill="#000000" font-family="Helvetica" font-size="12px">目录：go-cache...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>